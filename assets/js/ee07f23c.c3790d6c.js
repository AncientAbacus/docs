"use strict";(self.webpackChunkappcircle_docusaurus=self.webpackChunkappcircle_docusaurus||[]).push([[32756],{35123:(e,s,t)=>{t.d(s,{Ay:()=>c,RM:()=>r});var o=t(74848),i=t(28453);const r=[];function n(e){const s={admonition:"admonition",code:"code",p:"p",strong:"strong",...(0,i.R)(),...e.components};return(0,o.jsxs)(s.admonition,{type:"caution",children:[(0,o.jsxs)(s.p,{children:["The build token ID, generated at the start of the build, expires after ",(0,o.jsx)(s.strong,{children:"3 hours"}),". If the ",(0,o.jsx)(s.strong,{children:"Cache Pull"})," or ",(0,o.jsx)(s.strong,{children:"Cache Push"})," step starts beyond this time, caching will fail."]}),(0,o.jsxs)(s.p,{children:["This may lead to a ",(0,o.jsx)(s.code,{children:"404 Error"})," in the ",(0,o.jsx)(s.strong,{children:"Cache Pull"})," step during the next build if the ",(0,o.jsx)(s.strong,{children:"Cache Push"})," step is not completed successfully."]})]})}function c(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(n,{...e})}):n(e)}},35246:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>h,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"workflows/common-workflow-steps/build-cache/cache-push","title":"Cache Push","description":"Optimize your workflow by utilizing Cache Push to save and streamline data access, improving speed and reliability in your projects.","source":"@site/docs/workflows/common-workflow-steps/build-cache/cache-push.md","sourceDirName":"workflows/common-workflow-steps/build-cache","slug":"/workflows/common-workflow-steps/build-cache/cache-push","permalink":"/workflows/common-workflow-steps/build-cache/cache-push","draft":false,"unlisted":false,"editUrl":"https://github.com/appcircleio/appcircle-docusaurus/tree/master/docs/workflows/common-workflow-steps/build-cache/cache-push.md","tags":[{"inline":false,"label":"cache push","permalink":"/tags/cache-push","description":"Description for cache push"},{"inline":false,"label":"optimization","permalink":"/tags/optimization","description":"Description for optimization"},{"inline":false,"label":"storage","permalink":"/tags/storage","description":"Description for storage"},{"inline":false,"label":"dependencies","permalink":"/tags/dependencies","description":"Description for dependencies"},{"inline":false,"label":"cache structure","permalink":"/tags/cache-structure","description":"Description for cache structure"}],"version":"current","frontMatter":{"title":"Cache Push","description":"Optimize your workflow by utilizing Cache Push to save and streamline data access, improving speed and reliability in your projects.","tags":["cache push","optimization","storage","dependencies","cache structure"]},"sidebar":"mySidebar","previous":{"title":"Cache Pull","permalink":"/workflows/common-workflow-steps/build-cache/cache-pull"},"next":{"title":"How to Share Files Between Build Profiles","permalink":"/workflows/common-workflow-steps/build-cache/how-to-share-file-between-build-profiles"}}');var i=t(74848),r=t(28453),n=t(69678),c=t(35123);const a={title:"Cache Push",description:"Optimize your workflow by utilizing Cache Push to save and streamline data access, improving speed and reliability in your projects.",tags:["cache push","optimization","storage","dependencies","cache structure"]},l="Cache Push",h={},d=[...c.RM,{value:"Prerequisites",id:"prerequisites",level:3},{value:"Input Variables",id:"input-variables",level:3},{value:"Output Variables",id:"output-variables",level:3}];function p(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components},{ExternalUrlRef:t}=s;return t||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("ExternalUrlRef",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"cache-push",children:"Cache Push"})}),"\n",(0,i.jsxs)(s.p,{children:["Every single build at Appcircle runs in a clean state. It means that all files and folders that are not versioned in the Git repository are lost when the build pipeline is completed. For example, install dependencies or build artifacts. If you need to keep those files and folders, you can use the Appcircle ",(0,i.jsx)(s.strong,{children:"Cache Push"})," and ",(0,i.jsx)(s.a,{href:"/workflows/common-workflow-steps/build-cache/cache-pull",children:(0,i.jsx)(s.strong,{children:"Cache Pull"})})," components."]}),"\n",(0,i.jsxs)(s.p,{children:["With cache, you can persist any resource that is ignored by Git. So you can transfer files and folders between build pipelines. Sometimes it may speed up your build, or it may help if you have reliability issues with the original download location for dependencies. But keep in mind that the cache is uploaded to or downloaded from a remote location. It may help you in some cases, but ",(0,i.jsx)(s.strong,{children:"it's not a guaranteed way to speed up builds"}),". You should try and see the actual results of your project."]}),"\n",(0,i.jsxs)(s.p,{children:["The cache is stored as a single archive file. ",(0,i.jsx)(s.strong,{children:"Cache Push"})," and ",(0,i.jsx)(s.a,{href:"/workflows/common-workflow-steps/build-cache/cache-pull",children:(0,i.jsx)(s.strong,{children:"Cache Pull"})})," components work in coordination on the same cache file defined with a label. Cache labeling helps you organize your caches. With custom labeling, you can have different chunks of caches, and you can share some caches between branches or build profiles. For further information, please check out the following documentation:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"/workflows/common-workflow-steps/build-cache/how-to-share-file-between-pipelines",children:"How to Share Files Between Pipelines"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"/workflows/common-workflow-steps/build-cache/how-to-share-file-between-build-profiles",children:"How to Share Files Between Build Profiles"})}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["When you drag and drop the ",(0,i.jsx)(s.strong,{children:"Cache Push"})," component into your ",(0,i.jsx)(s.a,{href:"/workflows",children:"workflow"}),", it comes with pre-defined values according to your project type. For example, in the case of Android projects, it comes with pre-defined ",(0,i.jsx)(s.a,{href:"https://docs.gradle.org/current/userguide/build_cache.html",children:"Gradle cache"})," paths, which should prove useful for most Android apps."]}),"\n",(0,i.jsx)(c.Ay,{}),"\n",(0,i.jsxs)(s.p,{children:["If you need more paths to cache or need to change paths according to your project, you can customize ",(0,i.jsx)(s.a,{href:"#input-variables",children:"included"})," and ",(0,i.jsx)(s.a,{href:"#input-variables",children:"excluded"})," paths as you wish. All path updates will be reflected in the archived cache file on your next build."]}),"\n",(0,i.jsx)(s.admonition,{type:"danger",children:(0,i.jsxs)(s.p,{children:["You cannot delete a specific cache file from the UI, but if you have a problem with a cache file and need a fresh one, you can change your ",(0,i.jsx)(s.a,{href:"#input-variables",children:"cache label"})," to a new one to go on with a clean cache."]})}),"\n",(0,i.jsx)(s.admonition,{type:"info",children:(0,i.jsxs)(s.p,{children:["The system automatically cleans unreachable and obsolete cache files periodically. For this reason, ",(0,i.jsx)(s.strong,{children:"it's not guaranteed to reach a previously used cache file by using the previous cache label in build"}),". Also, it\u2019s a good idea to build your workflow in such a way that your ",(0,i.jsx)(s.strong,{children:"build won\u2019t fail if the cache can\u2019t be accessed"}),"."]})}),"\n",(0,i.jsx)(s.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(s.p,{children:["Before running the ",(0,i.jsx)(s.strong,{children:"Cache Push"})," step, you must complete certain prerequisites, as detailed in the table below:"]}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Prerequisite Workflow Step"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsx)(s.tbody,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.a,{href:"/workflows/common-workflow-steps/git-clone",children:(0,i.jsx)(s.strong,{children:"Git Clone"})})}),(0,i.jsxs)(s.td,{children:["If the folders to be cached are in the repo directory, the ",(0,i.jsx)(s.strong,{children:"Git Clone"})," step must be used before. This step will generate the ",(0,i.jsx)(s.a,{href:"#input-variables",children:(0,i.jsx)(s.code,{children:"$AC_REPOSITORY_DIR"})})," path."]})]})})]}),"\n",(0,i.jsx)(s.admonition,{type:"danger",children:(0,i.jsxs)(s.p,{children:["Keep in mind that included paths and the ",(0,i.jsx)(s.strong,{children:"Cache Push"})," step's workflow order are closely related to each other. For example, if you include a path from a repository and you place the ",(0,i.jsx)(s.strong,{children:"Cache Push"})," step before the ",(0,i.jsx)(s.strong,{children:"Git Clone"})," step, ",(0,i.jsx)(s.strong,{children:"Cache Push"})," won't find that path since it's not Git cloned yet. Although that's not a fatal error for ",(0,i.jsx)(s.strong,{children:"Cache Push"}),", it will inform you about unreachable paths on build logs. You can review and resolve those kinds of issues from build logs."]})}),"\n",(0,i.jsxs)(s.admonition,{type:"caution",children:[(0,i.jsxs)(s.p,{children:["The other important prerequisite for this component to work is that it must be used after the step in which the generated artifact of the step is to be cached. For example, in the screen shot, to cache dependencies, the ",(0,i.jsx)(s.strong,{children:"Cache Push"})," step is used after the ",(0,i.jsx)(s.a,{href:"/workflows/ios-specific-workflow-steps/cocoapods-install",children:(0,i.jsx)(s.strong,{children:"CocoaPods Install"})})," step."]}),(0,i.jsx)(n.A,{url:"https://cdn.appcircle.io/docs/assets/BE2911-pushOrder.png"})]}),"\n",(0,i.jsx)(s.h3,{id:"input-variables",children:"Input Variables"}),"\n",(0,i.jsx)(s.p,{children:"This step contains some input variable(s). It needs these variable(s) to work. The table below gives explanation for this variable(s)."}),"\n",(0,i.jsx)(n.A,{url:"https://cdn.appcircle.io/docs/assets/BE2911-pushInput.png"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Variable Name"}),(0,i.jsx)(s.th,{children:"Description"}),(0,i.jsx)(s.th,{children:"Status"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"$AC_CACHE_LABEL"})}),(0,i.jsxs)(s.td,{children:["User defined cache label to identify one cache from others. Both ",(0,i.jsx)(s.strong,{children:"Cache Push"})," and ",(0,i.jsx)(s.strong,{children:"Cache Pull"})," steps should have the same value to match."]}),(0,i.jsx)(s.td,{children:"Required"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"$AC_CACHE_INCLUDED_PATHS"})}),(0,i.jsxs)(s.td,{children:["Specifies the files and folders that should be in the cache. Multiple glob patterns can be provided as a colon-separated list. For example; ",(0,i.jsx)(s.code,{children:".gradle:app/build"})," or ",(0,i.jsx)(s.code,{children:"Pods:Podfile.lock"}),"."]}),(0,i.jsx)(s.td,{children:"Required"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"$AC_CACHE_EXCLUDED_PATHS"})}),(0,i.jsxs)(s.td,{children:["Specifies the files and folders that should be ignored from the cache. Multiple glob patterns can be provided as a colon-separated list. For example, ",(0,i.jsx)(s.code,{children:".gradle/*.lock:*.apk"}),"."]}),(0,i.jsx)(s.td,{children:"Optional"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"$AC_REPOSITORY_DIR"})}),(0,i.jsxs)(s.td,{children:["Specifies the cloned repository path. This path will be generated after running the ",(0,i.jsx)(s.a,{href:"/workflows/common-workflow-steps/git-clone",children:(0,i.jsx)(s.strong,{children:"Git Clone"})})," step."]}),(0,i.jsx)(s.td,{children:"Optional"})]})]})]}),"\n",(0,i.jsx)(s.admonition,{type:"tip",children:(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Cache Push"})," uses a pattern in order to select files and folders. Although the pattern is not a RegExp, it's closer to a shell glob. For example, ",(0,i.jsx)(s.code,{children:"~/Library/Caches/CocoaPods"})," and ",(0,i.jsx)(s.code,{children:"Pods"})," will select the ",(0,i.jsx)(s.code,{children:"CocoaPods"})," folder from home and the repository direction as a whole. Or for an Android project, you can cache the ",(0,i.jsx)(s.code,{children:".gradle "})," folder with ",(0,i.jsx)(s.code,{children:"~/.gradle"})," include path and exclude all ",(0,i.jsx)(s.code,{children:".lock"})," files from there with ",(0,i.jsx)(s.code,{children:"~/.gradle/**/*.lock"})," exclude path. Patterns that can be used in both included and excluded paths are explained in detail ",(0,i.jsx)(s.a,{href:"https://github.com/appcircleio/appcircle-cache-push-component#included--excluded-paths",children:"here"}),"."]})}),"\n",(0,i.jsx)(s.h3,{id:"output-variables",children:"Output Variables"}),"\n",(0,i.jsxs)(s.p,{children:["You cannot reach the cache archive file directly by yourself. But you can see cache file updates and track changes to cache at the end of the build pipeline from '",(0,i.jsx)(s.a,{href:"/workflows/common-workflow-steps/export-build-artifacts#download-exported-artifacts",children:"Download Artifacts"})," > ",(0,i.jsx)(s.code,{children:"ac_cache.zip"}),"'. Also, build logs have some useful information about the cache mechanism and how included and excluded paths are processed. You can see the produced cache file size from the build logs. (The size of the cache file affects upload and download durations.)"]}),"\n",(0,i.jsx)(s.admonition,{type:"caution",children:(0,i.jsxs)(s.p,{children:["To view the generated artifacts on the ",(0,i.jsx)(s.a,{href:"/workflows/common-workflow-steps/export-build-artifacts#download-exported-artifacts",children:(0,i.jsx)(s.strong,{children:"Download Artifacts"})})," page, please ensure that the ",(0,i.jsx)(s.a,{href:"/workflows/common-workflow-steps/export-build-artifacts",children:(0,i.jsx)(s.strong,{children:"Export Build Artifacts"})})," step is included in the ",(0,i.jsx)(s.a,{href:"/workflows",children:"workflow"})," after this step."]})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.p,{children:"To access the source code of this component, please use the following link:"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/appcircleio/appcircle-cache-push-component",children:(0,i.jsx)(t,{url:"https://github.com/appcircleio/appcircle-cache-push-component",title:"GitHub - appcircleio/appcircle-cache-push-component",description:"Contribute to appcircleio/appcircle-cache-push-component development by creating an account on GitHub.",image:"https://opengraph.githubassets.com/780b9872b21ec2ef5b61e2105206f1856e87d913ed17a8c061a34510b20fa61a/appcircleio/appcircle-cache-push-component"})})})]})}function u(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(p,{...e})}):p(e)}},69678:(e,s,t)=>{t.d(s,{A:()=>i});t(96540);var o=t(74848);function i(e){let{url:s,alt:t}=e;return(0,o.jsx)("img",{className:"screenshot",src:s,alt:t||"Screenshot"})}},28453:(e,s,t)=>{t.d(s,{R:()=>n,x:()=>c});var o=t(96540);const i={},r=o.createContext(i);function n(e){const s=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:n(e.components),o.createElement(r.Provider,{value:s},e.children)}}}]);